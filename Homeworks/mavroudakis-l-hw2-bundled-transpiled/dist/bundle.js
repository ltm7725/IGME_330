(()=>{"use strict";function e(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){u=!0,c=e},f:function(){try{l||null==r.return||r.return()}finally{if(u)throw c}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var n,r,o,a,c,l,u,i,s,d,p=function(t,n,r,o,a,c,l,u){var i,s=t.createRadialGradient(n,r,o,a,c,l),d=e(u);try{for(d.s();!(i=d.n()).done;){var p=i.value;s.addColorStop(p.percent,p.color)}}catch(e){d.e(e)}finally{d.f()}return s},y=Object.freeze({gain:.5,numSamples:256}),m=(new Uint8Array(y.numSamples/2),function(e){r.src=e}),h=function(e){d=!1,e=Number(e),c.gain.value=e,document.querySelector("#volume-label").innerHTML=Math.round(50*e)+"%",document.querySelector("#volume-slider").value=e,document.querySelector("#volume-label").style.color=e>2?"orange":"rgb(202, 225, 230)"};function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,c,l=[],u=!0,i=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){i=!0,o=e}finally{try{if(!u&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(i)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e,t){if("object"!=g(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}var q,w,A,x,k,M,C,T,I,E,L,j,R,O,F,H=function(){return e=function e(t,n,r,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"squares",c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n,this.colors=r,this.maxScale=o,this.type=a,this.tiltAngle=c,this.totalRotation=l,this.devSprite=u,this.minScale=1e-4,this.done=[];for(var i=0;i<this.colors.length;i++)this.done[i]=!1;this.swapAngle=c},t=[{key:"update",value:function(e){var t=b(e,4),n=t[0],r=t[1],o=t[2],a=t[3],c=this.minScale*(.9-(o-1)/this.colors.length*.9+.1),l=this.minScale*(.9-(o-1)/this.colors.length*.9+.1),u=c,i=l;return n+=this.tiltAngle,a.invInterp?"wav"==document.querySelector("#switch").choice?(u=c+r[Math.round(o/this.colors.length*127)]%127/255*(c/this.minScale*(this.maxScale-this.minScale)),i=l+r[Math.round(o/this.colors.length*127)]%127/255*(l/this.minScale*(this.maxScale-this.minScale)),this.devSprite&&(u*=2,i*=2),127!=r[Math.round(o/this.colors.length*127)]&&128!=r[Math.round(o/this.colors.length*127)]||(u=0,i=0)):(u=c+(1-r[Math.round(o/this.colors.length*127)]/255)*(c/this.minScale*(this.maxScale-this.minScale)),i=l+(1-r[Math.round(o/this.colors.length*127)]/255)*(l/this.minScale*(this.maxScale-this.minScale)),this.devSprite&&("squares"==this.type?(u*=3,i*=3):(u*=2.25,i*=2.25))):"wav"==document.querySelector("#switch").choice?(u=c+r[Math.round(o/this.colors.length*127)]/255*(c/this.minScale*(this.maxScale-this.minScale)),i=l+r[Math.round(o/this.colors.length*127)]/255*(l/this.minScale*(this.maxScale-this.minScale)),this.devSprite&&(u*=1.5,i*=1.5),127!=r[Math.round(o/this.colors.length*127)]&&128!=r[Math.round(o/this.colors.length*127)]||(u=0,i=0)):(u=c+r[Math.round(o/this.colors.length*127)]/255*(c/this.minScale*(this.maxScale-this.minScale)),i=l+r[Math.round(o/this.colors.length*127)]/255*(l/this.minScale*(this.maxScale-this.minScale)),0==r[6]&&(u=0,i=0)),a.drawVortex&&(u*=1.5,i*=1.5),[c,l,u,i,n]}},{key:"draw",value:function(e,t,n){this.swapAngle!=this.tiltAngle&&(this.tiltAngle=Math.round(this.swapAngle));for(var r=-this.tiltAngle,o=1;o<this.colors.length+1;o++){var a,c,l=b(this.update([r,t,o,n]),5);l[0],l[1],a=l[2],c=l[3],r=l[4],e.save(),e.translate(this.x,this.y),e.rotate(this.totalRotation/360*(2*Math.PI)),e.rotate(r/360*(2*Math.PI)),e.translate(this.minScale/2-a/2,this.minScale/2-c/2),("circles"==this.type&&n.showCircles||"squares"==this.type&&n.showSquares)&&("circles"==this.type?e.fillStyle=p(e,a/2,c/2,a/4,a/2,c/2,a/2,[{percent:.25,color:this.colors[o-1]},{percent:1,color:"transparent"}]):n.drawVortex?e.fillStyle=p(e,a/2,c/2,10,a/2,c/2,1.6*a,[{percent:.25,color:this.colors[o-1]},{percent:.325,color:"transparent"}]):e.fillStyle=p(e,a/2,c/2,10,a/2,c/2,1.6*a,[{percent:0,color:this.colors[o-1]},{percent:.9,color:"transparent"}]),e.beginPath(),e.fillRect(0,0,a,c),e.closePath(),e.fill()),e.restore()}}}],t&&S(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),z=function(t,n){q=t.getContext("2d"),w=t.width,A=t.height,C=new H(w/2,A/2,["magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","rgb(0,128,255)","magenta","cyan","purple","black"],200,"squares",46,0,!0),T=new H(w/2,A/2,["cyan","magenta","yellow","purple","cyan","magenta","yellow","purple","cyan","magenta","yellow","purple"],700,"circles",0,0,!0);var r=document.querySelector("#square-angle-slider"),o=document.querySelector("#square-angle-label");r.oninput=function(e){C.swapAngle=r.value,o.innerHTML=r.value+"Â°"},(I=window.matchMedia("(max-height: 94.55vw)")).addEventListener("change",(function(){!function(e){var t=document.querySelector("#switch-div"),n=document.querySelector("#bottom-controls"),r=document.querySelector("#checkboxes"),o=document.querySelector("#controls-button"),a=document.querySelector("#pop-controls");e.matches?(t.style.display="none",n.style.display="none",r.style.display="none"):("yes"==o.open&&(o.open="no",o.innerHTML="Open<br>Controls",a.style.display="none",document.querySelector("#controls").prepend(document.querySelector("#switch-div")),document.querySelector("#main-controls").appendChild(document.querySelector("#bottom-controls")),document.querySelector("#controls").appendChild(document.querySelector("#checkboxes"))),t.style.display="flex",n.style.display="block",r.style.display="flex")}(I)})),x=function(t,n,r,o,a,c){var l,u=t.createLinearGradient(0,0,0,a),i=e([{percent:0,color:"cyan"},{percent:.3125,color:"rgb(0,128,255)"},{percent:.6875,color:"rgb(128,0,255)"},{percent:1,color:"magenta"}]);try{for(i.s();!(l=i.n()).done;){var s=l.value;u.addColorStop(s.percent,s.color)}}catch(e){i.e(e)}finally{i.f()}return u}(q,0,0,0,A),k=n,M=new Uint8Array(k.fftSize/2)};function P(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D=Object.freeze({sound1:"media/New Adventure Theme.mp3"}),V={invInterp:!1,showGradient:!0,showBars:!0,showCircles:!0,showSquares:!0,showNoise:!0,showInvert:!1,showEmboss:!1,drawVortex:!1},G=function(e){e.matches?(0==V.showSquares&&(document.querySelector("#switch-div").style.transform="translate(0, 5.5vw)"),document.querySelectorAll("#checkboxes span")[0].appendChild(document.querySelector("#gradient-cb")),document.querySelectorAll("#checkboxes span")[1].appendChild(document.querySelector("#bars-cb")),document.querySelectorAll("#checkboxes span")[2].appendChild(document.querySelector("#circles-cb")),document.querySelectorAll("#checkboxes span")[3].appendChild(document.querySelector("#squares-cb")),document.querySelectorAll("#checkboxes span")[4].appendChild(document.querySelector("#noise-cb")),document.querySelectorAll("#checkboxes span")[5].appendChild(document.querySelector("#invert-cb")),document.querySelectorAll("#checkboxes span")[6].appendChild(document.querySelector("#emboss-cb"))):(0==V.showSquares&&(document.querySelector("#switch-div").style.transform="translate(0,-1vw)"),document.querySelectorAll("#checkboxes span")[0].prepend(document.querySelector("#gradient-cb")),document.querySelectorAll("#checkboxes span")[1].prepend(document.querySelector("#bars-cb")),document.querySelectorAll("#checkboxes span")[2].prepend(document.querySelector("#circles-cb")),document.querySelectorAll("#checkboxes span")[3].prepend(document.querySelector("#squares-cb")),document.querySelectorAll("#checkboxes span")[4].prepend(document.querySelector("#noise-cb")),document.querySelectorAll("#checkboxes span")[5].prepend(document.querySelector("#invert-cb")),document.querySelectorAll("#checkboxes span")[6].prepend(document.querySelector("#emboss-cb")))},N=function(e){document.querySelector("#fs-button").addEventListener("click",(function(t){var n;(n=e).requestFullscreen?n.requestFullscreen():n.mozRequestFullscreen?n.mozRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()}));var t=document.querySelector("#play-button");t.addEventListener("click",(function(e){"suspended"==n.state&&n.resume(),"no"==e.target.dataset.playing?(r.play(),e.target.dataset.playing="yes"):(r.pause(),e.target.dataset.playing="no")}));var o=document.querySelector("#controls-button"),a=document.querySelector("#pop-controls"),p=document.querySelector("#controls"),y=document.querySelector("#main-controls");document.querySelector("#controls"),o.addEventListener("click",(function(e){"yes"==e.target.open?(e.target.open="no",e.target.innerHTML="Open<br>Controls",a.style.display="none",p.prepend(document.querySelector("#switch-div")),y.appendChild(document.querySelector("#bottom-controls")),p.appendChild(document.querySelector("#checkboxes")),document.querySelector("#switch-div").style.display="none",document.querySelector("#bottom-controls").style.display="none",document.querySelector("#checkboxes").style.display="none"):(e.target.open="yes",e.target.innerHTML="Close<br>Controls",a.appendChild(document.querySelector("#switch-div")),a.appendChild(document.querySelector("#bottom-controls")),a.appendChild(document.querySelector("#checkboxes")),document.querySelector("#switch-div").style.display="flex",document.querySelector("#bottom-controls").style.display="block",document.querySelector("#checkboxes").style.display="flex",a.style.display="flex")}));var g=document.querySelector("#switch"),b=document.querySelector("#switch-img");g.choice="freq",g.addEventListener("click",(function(){"wav"==g.choice?(g.choice="freq",b.src="media/switch-up.png"):(g.choice="wav",b.src="media/switch-down.png")}));var f=document.querySelector("#volume-slider");document.querySelector("#volume-label"),j=document.querySelector("#treble-slider");var S=document.querySelector("#treble-label");R=document.querySelector("#bass-slider");var v=document.querySelector("#bass-label");O=document.querySelector("#distortion-slider");var q=document.querySelector("#distortion-label");E=0,L=0,f.oninput=function(e){h(e.target.value)},j.oninput=function(e){var t;E=j.value,j.value=(t=E,l.frequency.setValueAtTime(1e3,n.currentTime),l.gain.setValueAtTime(t/100*25,n.currentTime),Math.round(l.gain.value/25*100)!=t&&"yes"==document.querySelector("#play-button").dataset.playing?Math.round(l.gain.value/25*100):t),S.innerHTML=j.value+"%"},R.oninput=function(e){var t;L=R.value,R.value=(t=L,u.frequency.setValueAtTime(1e3,n.currentTime),u.gain.setValueAtTime(t/100*20,n.currentTime),Math.round(u.gain.value/20*100)!=t&&"yes"==document.querySelector("#play-button").dataset.playing?Math.round(u.gain.value/20*100):t),v.innerHTML=R.value+"%"},O.oninput=function(e){var t;t=O.value,distortion?(i.curve=null,i.curve=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=new Float32Array(256),n=0;n<256;++n){var r=2*n/256-1;t[n]=(Math.PI+e)*r/(Math.PI+e*Math.abs(r))}return t}(t),d||(s=c.gain.value,d=!0),h(t/12)):(i.curve=null,c.gain.value=Number(s),d=!1),q.innerHTML=O.value+"%"},f.dispatchEvent(new Event("input")),document.querySelector("#track-select").onchange=function(e){m(e.target.value),"yes"==t.dataset.playing&&t.dispatchEvent(new MouseEvent("click"))},document.querySelector("#inv-interp-switch").onchange=function(e){V.invInterp=e.target.checked},document.querySelector("#gradient-cb").onchange=function(e){V.showGradient=e.target.checked},document.querySelector("#bars-cb").onchange=function(e){V.showBars=e.target.checked},document.querySelector("#circles-cb").onchange=function(e){V.showCircles=e.target.checked},document.querySelector("#squares-cb").onchange=function(e){V.showSquares=e.target.checked},document.querySelector("#noise-cb").onchange=function(e){V.showNoise=e.target.checked},document.querySelector("#invert-cb").onchange=function(e){V.showInvert=e.target.checked},document.querySelector("#emboss-cb").onchange=function(e){V.showEmboss=e.target.checked},document.querySelector("#vortex").onchange=function(e){V.drawVortex=e.target.checked}},U=function e(){setTimeout(e,1e3/F),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"wav"==document.querySelector("#switch").choice?k.getByteTimeDomainData(M):k.getByteFrequencyData(M),q.save(),q.fillStyle="black",q.globalAlpha=.1,q.fillRect(0,0,w,A),q.restore(),e.showGradient&&(q.save(),q.fillStyle=x,q.globalAlpha=.2,q.fillRect(0,0,w,A),q.restore()),T.draw(q,M,e);for(var t=q.getImageData(0,0,w,A),n=t.data,r=n.length,o=t.width,a=0;a<r;a+=4)e.showNoise&&Math.random()<.05&&(n[a]=255-n[a],n[a+1]=255-n[a+1],n[a+2]=255-n[a+2]);if(q.putImageData(t,0,0),e.showBars){var c=(w-4*M.length)/M.length,l=200;q.save(),q.fillStyle="rgba(255,255,255,0.50)",q.strokeStyle="rgba(0,0,0,0.50)";for(var u=0;u<M.length;u++)e.invInterp?(q.fillRect(2+u*(c+4),100+M[u]-120,c,l),q.strokeRect(2+u*(c+4),100+M[u]-100,c,l)):(q.fillRect(2+u*(c+4),356-M[u]-120,c,l),q.strokeRect(2+u*(c+4),356-M[u]-100,c,l));q.restore()}if(C.draw(q,M,e),r=(n=(t=q.getImageData(0,0,w,A)).data).length,o=t.width,e.showInvert)for(var i=0;i<r;i+=4){var s=n[i],d=n[i+1],p=n[i+2];n[i]=255-s,n[i+1]=255-d,n[i+2]=255-p}if(e.showEmboss)for(var y=0;y<r;y++)y%4!=3&&(n[y]=127+2*n[y]-n[y+4]-n[y+4*o]);q.putImageData(t,0,0)}(V);var t=new Uint8Array(a.fftSize/2);a.getByteFrequencyData(t),t.reduce((function(e,t){return e+t})),a.fftSize,Math.min.apply(Math,P(t)),Math.max.apply(Math,P(t)),t[11]};window.onload=function(){!function(){var e,t;(e=new XMLHttpRequest).onload=function(e){var t,n=e.target.responseText,r=JSON.parse(n);document.querySelector("title").innerHTML=r.title,document.querySelector("#warning").innerHTML=r["distortion-warning"];for(var o=0;o<r.files.length;o++)t+=0==o?'<option value="'.concat(r.files[o],'" selected>').concat(r.tracks[o],"</option>"):'<option value="'.concat(r.files[o],'">').concat(r.tracks[o],"</option>");document.querySelector("#track-select").innerHTML=t},e.open("GET","data/av-data.json"),e.send(),t=D.sound1,window.AudioContext||window.webkitAudioContext,n=new AudioContext,r=new Audio,m(t),o=n.createMediaElementSource(r),(a=n.createAnalyser()).fftSize=y.numSamples,(c=n.createGain()).gain.value=y.gain,(l=n.createBiquadFilter()).type="highshelf",(u=n.createBiquadFilter()).type="lowshelf",i=n.createWaveShaper(),o.connect(i),i.connect(l),l.connect(u),u.connect(a),a.connect(c),c.connect(n.destination),F=60;var s=window.matchMedia("(max-height: 94.55vw)");G(s),r.addEventListener("ended",(function(){document.querySelector("#play-button").setAttribute("data-playing","no")})),document.querySelector("#squares-cb").addEventListener("change",(function(e){e.target.checked?(document.querySelector("#square-angle").style.display="flex",document.querySelector("#vortex").style.display="flex",s.matches&&(document.querySelector("#switch-div").style.transform="translate(0, 0vw)")):(s.matches&&(document.querySelector("#switch-div").style.transform="translate(0, 5.5vw)"),document.querySelector("#vortex").style.display="none",document.querySelector("#square-angle").style.display="none")})),s.addEventListener("change",(function(){G(s)}));var d=document.querySelector("canvas");N(d),z(d,a),U()}()}})();